{% extends "base.html" %}
{% load humanize %}

{% block title %}
    <title>Избранные товары</title>
{% endblock %}

{% block content %}
    <div class="container mt-4">
        <h2>Избранные товары</h2>

        {% if favorites %}
            <div class="row">
                {% for favorite in favorites %}
                    <div class="col-sm-6 col-md-4 col-lg-3 mb-4">
                        <div class="card h-100" style="width: 100%; max-width: 18rem;">
                            {% if favorite.part.image1 %}
                                <img src="{{ favorite.part.image1.url }}" class="card-img-top" alt="{{ favorite.part.name }}" style="height: 150px; object-fit: cover;">
                            {% else %}
                                <img src="/images/placeholder-1.png" class="card-img-top" alt="Нет изображения" style="height: 150px; object-fit: cover;">
                            {% endif %}

                            <div class="card-body d-flex flex-column">
                                <h6 class="card-title">
                                    <a href = "{% url 'webapp:part_detail' favorite.part.pk %}" class="text-dark text-decoration-none">
                                        {{ favorite.part.name }}
                                    </a>
                                </h6>

                                <p class="card-text mb-2">
                                    {% if favorite.part.current_price %}
                                        <span class="fw-bold text-danger">{{ favorite.part.current_price }} ₽</span>
                                    {% else %}
                                        <span class="text-muted">Цена не указана</span>
                                    {% endif %}
                                </p>

                                <div class="mt-auto d-flex justify-content-between">
                                    <form method="post" action="{% url 'webapp:favorite_delete' favorite.pk %}" class="d-inline">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-danger btn-sm">Удалить</button>
                                    </form>

                                    <form method="post" action="{% url 'webapp:part_add_cart' favorite.part.pk %}?next={{ request.get_full_path }}" class="add-to-cart-form">
                                        {% csrf_token %}
                                        <button class="btn btn-success btn-sm" type="submit">
                                            <i class="bi bi-cart"></i> В корзину
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <p>Список избранных товаров пуст.</p>
        {% endif %}
    </div>
{% endblock %}
